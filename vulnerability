import requests
import re

banner = "roundcube v0.1"

tmp = banner.split(" ")
service = tmp[0]
version = re.findall('\d+\.\d+', tmp[1])
version = version[0]

response = requests.get("http://cve.circl.lu/api/search/{}".format(service))
vuln = response.json()

for i in range(len(vuln['data'])):
    for j in range(len(vuln['data'][i]['vulnerable_configuration'])):
                   if version in vuln['data'][i]['vulnerable_configuration'][j]:
                       print(vuln['data'][i]['id'])
                       break
